# Colocar os arquivos .csv em /var/lib/mysql-files/ caso a opção de segurança
# esteja habilitada
for filename in ./*.csv; do
  echo $filename
  mkdir $(basename ${filename%.*})
  split -l 50000 $filename $(basename ${filename%.*})"/"
  tail -n +2 $(basename ${filename%.*})"/aa" > $(basename ${filename%.*})"/aa2"
  mv $(basename ${filename%.*})"/aa2" $(basename ${filename%.*})"/aa"
done

# Executar para cada ano de dados
for filename in ./2010/*; do
  echo "Processing $filename"
  # Essa linha é gerada pelo script `normalizer.py`, você deve prover os parâmetros para
  # importação dos dados
  mysql -udatascience -p<password> appenem -hfoster.cemfxnd3rpcm.us-east-1.rds.amazonaws.com -e "LOAD DATA INFILE '$(readlink -f $filename)' INTO TABLE rawdata FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' (@registration, @year, @consistency, @resident_city_code, @resident_city_name, @resident_state_code, @resident_state_name, @hospital_unity, @training, @school_code, @school_city_code, @school_city_name, @school_state_code, @school_state_name, @school_dependency, @school_location, @school_status, @age, @gender, @nationality, @birth_city_code, @birth_city_name, @birth_state_code, @birth_state_name, @conclusion, @conclusion_year, @school_type, @conclusion_type, @marital_status, @color, @low_vision, @blind, @deaf, @hearing_deficiency, @blind_deaf, @physical_disability, @mental_disability, @attention_deficit, @dyslexia, @pregnancy, @lactating, @elderly, @dyscalculia, @autism, @monocular_vision, @sabbatista, @other_deficiency, @resource, @social_name, @braille, @enlarged_big, @enlarged_medium, @reader, @easy_access, @transcription, @hand_talk, @lip_reading, @wheelchair, @separated_chair, @leg_support, @interpret_guide, @litter, @computer, @special_chair, @left_handed_chair, @padded_chair, @lying, @obese_furniture, @overlay_blade, @hearing_protector, @glucose_meter, @braille_machine, @soroban, @pacemaker, @probe, @medicine, @individual_room, @special_room, @companion_room, @specific_forniture, @specific_material, @other_necessity, @prison_unity, @certification, @certifier_name, @certifier_state_code, @certifier_state_name, @test_city_code, @test_city_name, @test_state_code, @test_state_name, @cn_presence, @ch_presence, @lc_presence, @mt_presence, @cn_test_code, @ch_test_code, @lc_test_code, @mt_test_code, @cn_score, @ch_score, @lc_score, @mt_score, @cn_answers, @ch_answers, @lc_answers, @mt_answers, @lc_type, @cn_key, @ch_key, @lc_key, @mt_key, @essay_status, @first_competence_score, @second_competence_score, @third_competence_score, @fourth_competence_score, @fifth_competence_score, @essay_score) SET registration = NULLIF(@registration, ''), year = NULLIF(@year, ''), consistency = NULLIF(@consistency, ''), resident_city_code = NULLIF(@resident_city_code, ''), resident_city_name = NULLIF(@resident_city_name, ''), resident_state_code = NULLIF(@resident_state_code, ''), resident_state_name = NULLIF(@resident_state_name, ''), hospital_unity = NULLIF(@hospital_unity, ''), training = NULLIF(@training, ''), school_code = NULLIF(@school_code, ''), school_city_code = NULLIF(@school_city_code, ''), school_city_name = NULLIF(@school_city_name, ''), school_state_code = NULLIF(@school_state_code, ''), school_state_name = NULLIF(@school_state_name, ''), school_dependency = NULLIF(@school_dependency, ''), school_location = NULLIF(@school_location, ''), school_status = NULLIF(@school_status, ''), age = NULLIF(@age, ''), gender = NULLIF(@gender, ''), nationality = NULLIF(@nationality, ''), birth_city_code = NULLIF(@birth_city_code, ''), birth_city_name = NULLIF(@birth_city_name, ''), birth_state_code = NULLIF(@birth_state_code, ''), birth_state_name = NULLIF(@birth_state_name, ''), conclusion = NULLIF(@conclusion, ''), conclusion_year = NULLIF(@conclusion_year, ''), school_type = NULLIF(@school_type, ''), conclusion_type = NULLIF(@conclusion_type, ''), marital_status = NULLIF(@marital_status, ''), color = NULLIF(@color, ''), low_vision = NULLIF(@low_vision, ''), blind = NULLIF(@blind, ''), deaf = NULLIF(@deaf, ''), hearing_deficiency = NULLIF(@hearing_deficiency, ''), blind_deaf = NULLIF(@blind_deaf, ''), physical_disability = NULLIF(@physical_disability, ''), mental_disability = NULLIF(@mental_disability, ''), attention_deficit = NULLIF(@attention_deficit, ''), dyslexia = NULLIF(@dyslexia, ''), pregnancy = NULLIF(@pregnancy, ''), lactating = NULLIF(@lactating, ''), elderly = NULLIF(@elderly, ''), dyscalculia = NULLIF(@dyscalculia, ''), autism = NULLIF(@autism, ''), monocular_vision = NULLIF(@monocular_vision, ''), sabbatista = NULLIF(@sabbatista, ''), other_deficiency = NULLIF(@other_deficiency, ''), resource = NULLIF(@resource, ''), social_name = NULLIF(@social_name, ''), braille = NULLIF(@braille, ''), enlarged_big = NULLIF(@enlarged_big, ''), enlarged_medium = NULLIF(@enlarged_medium, ''), reader = NULLIF(@reader, ''), easy_access = NULLIF(@easy_access, ''), transcription = NULLIF(@transcription, ''), hand_talk = NULLIF(@hand_talk, ''), lip_reading = NULLIF(@lip_reading, ''), wheelchair = NULLIF(@wheelchair, ''), separated_chair = NULLIF(@separated_chair, ''), leg_support = NULLIF(@leg_support, ''), interpret_guide = NULLIF(@interpret_guide, ''), litter = NULLIF(@litter, ''), computer = NULLIF(@computer, ''), special_chair = NULLIF(@special_chair, ''), left_handed_chair = NULLIF(@left_handed_chair, ''), padded_chair = NULLIF(@padded_chair, ''), lying = NULLIF(@lying, ''), obese_furniture = NULLIF(@obese_furniture, ''), overlay_blade = NULLIF(@overlay_blade, ''), hearing_protector = NULLIF(@hearing_protector, ''), glucose_meter = NULLIF(@glucose_meter, ''), braille_machine = NULLIF(@braille_machine, ''), soroban = NULLIF(@soroban, ''), pacemaker = NULLIF(@pacemaker, ''), probe = NULLIF(@probe, ''), medicine = NULLIF(@medicine, ''), individual_room = NULLIF(@individual_room, ''), special_room = NULLIF(@special_room, ''), companion_room = NULLIF(@companion_room, ''), specific_forniture = NULLIF(@specific_forniture, ''), specific_material = NULLIF(@specific_material, ''), other_necessity = NULLIF(@other_necessity, ''), prison_unity = NULLIF(@prison_unity, ''), certification = NULLIF(@certification, ''), certifier_name = NULLIF(@certifier_name, ''), certifier_state_code = NULLIF(@certifier_state_code, ''), certifier_state_name = NULLIF(@certifier_state_name, ''), test_city_code = NULLIF(@test_city_code, ''), test_city_name = NULLIF(@test_city_name, ''), test_state_code = NULLIF(@test_state_code, ''), test_state_name = NULLIF(@test_state_name, ''), cn_presence = NULLIF(@cn_presence, ''), ch_presence = NULLIF(@ch_presence, ''), lc_presence = NULLIF(@lc_presence, ''), mt_presence = NULLIF(@mt_presence, ''), cn_test_code = NULLIF(@cn_test_code, ''), ch_test_code = NULLIF(@ch_test_code, ''), lc_test_code = NULLIF(@lc_test_code, ''), mt_test_code = NULLIF(@mt_test_code, ''), cn_score = NULLIF(@cn_score, ''), ch_score = NULLIF(@ch_score, ''), lc_score = NULLIF(@lc_score, ''), mt_score = NULLIF(@mt_score, ''), cn_answers = NULLIF(@cn_answers, ''), ch_answers = NULLIF(@ch_answers, ''), lc_answers = NULLIF(@lc_answers, ''), mt_answers = NULLIF(@mt_answers, ''), lc_type = NULLIF(@lc_type, ''), cn_key = NULLIF(@cn_key, ''), ch_key = NULLIF(@ch_key, ''), lc_key = NULLIF(@lc_key, ''), mt_key = NULLIF(@mt_key, ''), essay_status = NULLIF(@essay_status, ''), first_competence_score = NULLIF(@first_competence_score, ''), second_competence_score = NULLIF(@second_competence_score, ''), third_competence_score = NULLIF(@third_competence_score, ''), fourth_competence_score = NULLIF(@fourth_competence_score, ''), fifth_competence_score = NULLIF(@fifth_competence_score, ''), essay_score = NULLIF(@essay_score, '');"
done
